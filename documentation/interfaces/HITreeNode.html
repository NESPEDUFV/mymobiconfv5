<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>v4 documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">v4 documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>HITreeNode</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/utils/hi-tree.ts</code>
        </p>

            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Definição do nó da árvore HI</p>

            </p>


        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#height">height</a>
                                </li>
                                <li>
                                        <a href="#item">item</a>
                                </li>
                                <li>
                                        <a href="#left">left</a>
                                </li>
                                <li>
                                        <a href="#max">max</a>
                                </li>
                                <li>
                                        <a href="#right">right</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="height"></a>
                                        <span class="name"><b>height</b><a href="#height"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>height:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Altura da subárvore </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="item"></a>
                                        <span class="name"><b>item</b><a href="#item"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>item:     <code>T</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>T</code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Item a ser armazenado no nó </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="left"></a>
                                        <span class="name"><b>left</b><a href="#left"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>left:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>ID do nó à esquerda </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="max"></a>
                                        <span class="name"><b>max</b><a href="#max"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>max:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Máximo do intervalo na subárvore </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="right"></a>
                                        <span class="name"><b>right</b><a href="#right"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>right:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>ID do nó à direita </p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">interface HITreeNode&lt;T&gt; {
  /** Item a ser armazenado no nó */
  item: T
  /** Máximo do intervalo na subárvore */
  max: number
  /** ID do nó à esquerda */
  left: string
  /** ID do nó à direita */
  right: string
  /** Altura da subárvore */
  height: number
}

/**
* Implementação própria de uma mistura de tabela hash (H - Hash) mesclada
* com uma árvore de intervalo (I - Interval). Desta forma, permite uma busca por ID
* como também por intervalo. Esta implementação usa balanceamento AVL.
*/
export class HITree&lt;T&gt; {
  /** Nós da árvore */
  private nodes: { [ID: string]: HITreeNode&lt;T&gt; };
  /** ID do nó raiz */
  private root: string;

  /**
   * Cria uma nova árvore HI
   * @param id Função para extrair o ID do item
   * @param low Função para extrair o número menor do intervalo a partir do item
   * @param high Função para extrair o número maior do intervalo a partir do item
   * @param fromJSON Representação de string JSON a partir da qual a árvore deve ser montada
   */
  constructor(private id: (item: T) &#x3D;&gt; string, private low: (item: T) &#x3D;&gt; number,
      private high: (item: T) &#x3D;&gt; number, fromJSON?: string) {
      let jsonTree &#x3D; JSON.parse(fromJSON || null);
      if (jsonTree) {
          this.nodes &#x3D; jsonTree.nodes;
          this.root &#x3D; jsonTree.root;
      } else {
          this.nodes &#x3D; {};
          this.root &#x3D; null;
      }
  }

  /**
   * Retorna o item cujo ID coincide com &#x60;id&#x60;
   * @param id ID do item a ser retornado
   * @returns Item cujo ID coincide com &#x60;id&#x60;
   */
  getByID(id: string): T {
      return this.nodes[id].item;
  }

  /**
   * Filtra os itens da árvore procurando os intervalos que se sobrepõe com o intervalo passado
   * @param low Ponto inferior do intervalo
   * @param high Ponro superior do intervalo
   * @param exc Faz a análise dos intervalos ser exclusiva ao invés do padrão, inclusivo
   * @returns Lista com os itens da árvore cujo intervalo inclui o ponto &#x60;p&#x60;
   */
  getByInterval(low: number, high: number, exc?: boolean): T[] {
      let match: T[] &#x3D; [];
      let traverse &#x3D; (current: HITreeNode&lt;T&gt;) &#x3D;&gt; {
          if (!current)
              return;
          let item &#x3D; current.item;
          let afterLow &#x3D; exc ? this.low(item) &lt; high : this.low(item) &lt;&#x3D; high;
          let beforeHigh &#x3D; exc ? low &lt; this.high(item) : low &lt;&#x3D; this.high(item);
          let beforeMax &#x3D; exc ? low &lt; current.max : low &lt;&#x3D; current.max;
          if (beforeMax)
              traverse(this.nodes[current.left]);
          if (afterLow &amp;&amp; beforeHigh)
              match.push(item);
          if (afterLow &amp;&amp; beforeMax)
              traverse(this.nodes[current.right]);
      }
      traverse(this.nodes[this.root]);
      return match;
  }

  /**
   * Filtra os itens da árvore procurando os intervalos (inclusivos) que contém o ponto &#x60;p&#x60;
   * @param p Ponto de pesquisa nos intervalos
   * @param tolerance Adiciona uma margem de tolerância em volta do ponto
   * @param exc Faz a análise dos intervalos ser exclusiva ao invés do padrão, inclusivo
   * @returns Lista com os itens da árvore cujo intervalo inclui o ponto &#x60;p&#x60;
   */
  getByPoint(p: number, tolerance?: number, exc?: boolean): T[] {
      return this.getByInterval(p - (tolerance || 0), p + (tolerance || 0), exc);
  }

  /**
   * Adiciona um novo item na árvore
   * @param item Item a ser adicionado
   */
  add(item: T) {
      let id &#x3D; this.id(item);
      if (this.nodes[id]) return;
      let add &#x3D; (cID: string): string &#x3D;&gt; {
          let current &#x3D; this.nodes[cID];
          if (!current) {
              this.nodes[id] &#x3D; this.newNode(item);
              return id;
          }
          if (this.order(item, current.item) &lt; 0)
              current.left &#x3D; add(current.left);
          else
              current.right &#x3D; add(current.right);
          let bf &#x3D; this.bf(current);
          if (bf &lt; -1) {
              if (this.order(item, this.nodes[current.left].item) &lt; 0)
                  return this.rotR(cID);
              else
                  return this.rotLR(cID);
          } else if (bf &gt; 1) {
              if (this.order(item, this.nodes[current.right].item) &gt;&#x3D; 0)
                  return this.rotL(cID);
              else
                  return this.rotRL(cID);
          }
          this.update(current);
          return cID;
      }
      this.root &#x3D; add(this.root);
  }

  /**
   * Cria um novo nó contendo o item passado e o retorna
   * @param item Item a ser colocado no nó
   * @returns Novo nó contendo &#x60;item&#x60;
   */
  private newNode(item: T): HITreeNode&lt;T&gt; {
      return {
          item: item,
          max: this.high(item),
          left: null,
          right: null,
          height: 0
      }
  }

  /**
   * Retorna a altura da subárvore começada por um dado nó
   * @param id ID do nó cuja altura de sua subárvore é calculada
   * @returns O valor da altura da subárvore ou -1 caso o nó não exista
   */
  private ht(id: string): number {
      let node &#x3D; this.nodes[id];
      return node ? node.height : -1;
  }

  /**
   * Calcula o fator de balanceamento de um nó (&#x60;altura do filho à direita - altura do filho à esquerda&#x60;) e o retorna
   * @param node Nó cujo fator de balanceamento será calculado
   * @returns Fator de balanceamento
   */
  private bf(node: HITreeNode&lt;T&gt;): number {
      return this.ht(node.right) - this.ht(node.left);
  }

  /**
   * Atualiza os valores &#x60;height&#x60; e &#x60;max&#x60; do nó
   * @param node Nó cujos valores serão atualizados
   */
  private update(node: HITreeNode&lt;T&gt;) {
      node.max &#x3D; Math.max(
          this.high(node.item),
          node.left &amp;&amp; this.nodes[node.left].max,
          node.right &amp;&amp; this.nodes[node.right].max
      );
      node.height &#x3D; 1 + Math.max(this.ht(node.left), this.ht(node.right));
  }

  /**
   * Determina a ordem entre os itens
   * @param a Item a ser avaliado
   * @param b Item a ser avaliado
   * @returns Um número menor que 0, caso &#x60;a&#x60; venha antes de &#x60;b&#x60;; igual a 0 caso &#x60;a&#x60; e &#x60;b&#x60; tenham a mesma colocação; ou maior que 0 caso &#x60;a&#x60; venha depois de &#x60;b&#x60;
   */
  private order(a: T, b: T) {
      let dif &#x3D; this.low(a) - this.low(b);
      return dif ? dif : this.high(a) - this.high(b);
  }

  /**
   * Executa uma rotação à esquerda
   * @param root ID do nó raiz da subárvore, que servirá de ponto de partida para a rotação
   * @returns ID do nó que servirá de nova raiz da subárvore
   */
  private rotL(root: string): string {
      let rootNode &#x3D; this.nodes[root];
      let rt &#x3D; rootNode.right, rtNode &#x3D; this.nodes[rt];
      rootNode.right &#x3D; rtNode.left;
      rtNode.left &#x3D; root;
      this.update(rootNode);
      this.update(rtNode);
      return rt;
  }

  /**
   * Executa uma rotação à direita
   * @param root ID do nó raiz da subárvore, que servirá de ponto de partida para a rotação
   * @returns ID do nó que servirá de nova raiz da subárvore
   */
  private rotR(root: string): string {
      let rootNode &#x3D; this.nodes[root];
      let lt &#x3D; rootNode.left, ltNode &#x3D; this.nodes[lt];
      rootNode.left &#x3D; ltNode.right;
      ltNode.right &#x3D; root;
      this.update(rootNode);
      this.update(ltNode);
      return lt;
  }

  /**
   * Executa uma rotação esquerda-direita
   * @param root ID do nó raiz da subárvore, que servirá de ponto de partida para a rotação
   * @returns ID do nó que servirá de nova raiz da subárvore
   */
  private rotLR(root: string): string {
      let rootNode &#x3D; this.nodes[root];
      let lt &#x3D; rootNode.left, ltNode &#x3D; this.nodes[lt];
      let ltRt &#x3D; ltNode.right, ltRtNode &#x3D; this.nodes[ltRt];
      let endA &#x3D; ltRtNode.left, endB &#x3D; ltRtNode.right;
      ltRtNode.left &#x3D; lt; ltRtNode.right &#x3D; root;
      ltNode.right &#x3D; endA; rootNode.left &#x3D; endB;
      this.update(rootNode);
      this.update(ltNode);
      this.update(ltRtNode);
      return ltRt;
  }

  /**
   * Executa uma rotação direita-esquerda
   * @param root ID do nó raiz da subárvore, que servirá de ponto de partida para a rotação
   * @returns ID do nó que servirá de nova raiz da subárvore
   */
  private rotRL(root: string): string {
      let rootNode &#x3D; this.nodes[root];
      let rt &#x3D; rootNode.right, rtNode &#x3D; this.nodes[rt];
      let rtLt &#x3D; rtNode.left, rtLtNode &#x3D; this.nodes[rtLt];
      let endA &#x3D; rtLtNode.left, endB &#x3D; rtLtNode.right;
      rtLtNode.right &#x3D; rt; rtLtNode.left &#x3D; root;
      rootNode.right &#x3D; endA; rtNode.left &#x3D; endB;
      this.update(rootNode);
      this.update(rtNode);
      this.update(rtLtNode);
      return rtLt;
  }

  /**
   * Apaga toda a árvore
   */
  clear() {
      this.root &#x3D; null;
      for (let id in this.nodes)
          delete this.nodes[id];
  }

  /**
   * Realiza a ação especificada para cada elemento na árvore, percorrendo-a em ordem
   * @param callbackfn &#x60;forEach&#x60; chama a função &#x60;callbackfn&#x60; uma vez para cada elemento na árvore
   */
  forEach(callbackfn: (item: T, index: number) &#x3D;&gt; void) {
      let i &#x3D; 0;
      let traverse &#x3D; (current: HITreeNode&lt;T&gt;) &#x3D;&gt; {
          if (!current) return;
          traverse(this.nodes[current.left]);
          callbackfn(current.item, i++);
          traverse(this.nodes[current.right]);
      }
      traverse(this.nodes[this.root]);
  }

  /**
    * Determina se a callback especificada retorna &#x60;true&#x60; para algum elemento da árvore
    * @param callbackfn &#x60;some&#x60; chama a função &#x60;callbackfn&#x60; em cada elemento da árvore até encontrar algum que retorne &#x60;true&#x60; ou até acabar os elementos
    */
  some(callbackfn: (item: T) &#x3D;&gt; boolean): boolean {
      for (let id in this.nodes)
          if (callbackfn(this.nodes[id].item))
              return true;
      return false;
  }

  /**
   * Retorna uma array com os elementos da árvore que atendem à condição especificada na função &#x60;callbackfn&#x60;
   * @param callbackfn &#x60;filter&#x60; chama a função &#x60;callbackfn&#x60; uma vez para cada elemento na lista
   * @returns Os elementos da árvore que atendem à condição especificada na função &#x60;callbackfn&#x60;
   */
  filter(callbackfn: (item: T, index: number) &#x3D;&gt; boolean): T[] {
      let res: T[] &#x3D; [];
      this.forEach((item, i) &#x3D;&gt; { if (callbackfn(item, i)) res.push(item) });
      return res;
  }
}
</code></pre>
    </div>
</div>


                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'HITreeNode.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
